2023-07-05 13:11:12,986 - INFO - This will get logged to a file
2023-07-05 13:11:17,890 - INFO - Establishing connection
2023-07-05 13:11:17,914 - INFO - Connection established
2023-07-05 13:11:17,914 - INFO - find_sql_table_type: /Users/robinbuchta/Documents/DARPA/cadets/01_record/output/updated_nodes.csv
2023-07-05 13:11:19,394 - INFO - len of columns_with_datatype: 98
2023-07-05 13:11:19,394 - INFO - columns_with_type: subject_localprincipal varchar(255), principal_username text, fileobject_baseobject_permission text, principal_hostid varchar(255), srcsinkobject_type varchar(255), unnamedpipeobject_sinkfiledescriptor text, subject_type varchar(255), netflowobject_filedescriptor text, host_interfaces text, host_hostidentifiers text, unnamedpipeobject_baseobject_properties text, fileobject_uuid varchar(255), host_hosttype varchar(255), fileobject_baseobject_properties text, principal_groupids text, subject_starttimestampnanos BIGINT NULL, srcsinkobject_baseobject_hostid varchar(255), principal_type varchar(255), unnamedpipeobject_baseobject_permission text, source varchar(255), fileobject_type varchar(255), unnamedpipeobject_baseobject_properties_map text, datum text, subject_exportedlibraries text, host_interfaces_ipaddresses text, host_hostname varchar(255), subject_unitid text, srcsinkobject_baseobject_permission text, fileobject_baseobject_epoch text, unnamedpipeobject_sourcefiledescriptor text, unnamedpipeobject_sourceuuid_com_bbn_tc_schema_avro_cdm18_uuid varchar(255), netflowobject_ipprotocol text, netflowobject_uuid varchar(255), fileobject_filedescriptor text, unnamedpipeobject_sinkuuid text, netflowobject_baseobject text, unnamedpipeobject_baseobject text, netflowobject_localaddress varchar(255), subject_iteration text, srcsinkobject_baseobject text, unnamedpipeobject_baseobject_epoch text, host_interfaces_name text, subject_importedlibraries text, netflowobject_baseobject_hostid varchar(255), unnamedpipeobject_sourceuuid text, principal_userid INT NULL, principal_username_string varchar(255), principal_properties_map text, srcsinkobject_baseobject_properties_map text, principal text, netflowobject_localport varchar(255), subject_parentsubject text, srcsinkobject_filedescriptor text, subject_privilegelevel text, unnamedpipeobject text, subject_properties text, subject_cid INT NULL, srcsinkobject_baseobject_epoch text, host_osdetails varchar(255), fileobject_baseobject_properties_map text, subject_properties_map text, fileobject_size text, subject_properties_map_host varchar(255), subject_cmdline text, netflowobject_baseobject_permission text, principal_uuid varchar(255), srcsinkobject text, fileobject text, subject_parentsubject_com_bbn_tc_schema_avro_cdm18_uuid varchar(255), subject_count text, host text, netflowobject_baseobject_epoch text, netflowobject_remoteport INT NULL, subject_uuid varchar(255), netflowobject text, fileobject_baseobject_hostid varchar(255), principal_properties text, host_uuid varchar(255), srcsinkobject_baseobject_properties text, unnamedpipeobject_uuid varchar(255), netflowobject_baseobject_properties text, unnamedpipeobject_baseobject_hostid varchar(255), fileobject_localprincipal text, host_interfaces_macaddress text, fileobject_baseobject text, fileobject_peinfo text, netflowobject_baseobject_properties_map text, cdmversion INT NULL, unnamedpipeobject_sinkuuid_com_bbn_tc_schema_avro_cdm18_uuid varchar(255), srcsinkobject_uuid varchar(255), fileobject_hashes text, netflowobject_remoteaddress varchar(255), subject text, subject_hostid varchar(255), node_type varchar(255), collected_uuid varchar(255), uuid_numeration INT NULL, end_column INT NULL
2023-07-05 13:11:19,394 - INFO - columns: subject_localprincipal, principal_username, fileobject_baseobject_permission, principal_hostid, srcsinkobject_type, unnamedpipeobject_sinkfiledescriptor, subject_type, netflowobject_filedescriptor, host_interfaces, host_hostidentifiers, unnamedpipeobject_baseobject_properties, fileobject_uuid, host_hosttype, fileobject_baseobject_properties, principal_groupids, subject_starttimestampnanos, srcsinkobject_baseobject_hostid, principal_type, unnamedpipeobject_baseobject_permission, source, fileobject_type, unnamedpipeobject_baseobject_properties_map, datum, subject_exportedlibraries, host_interfaces_ipaddresses, host_hostname, subject_unitid, srcsinkobject_baseobject_permission, fileobject_baseobject_epoch, unnamedpipeobject_sourcefiledescriptor, unnamedpipeobject_sourceuuid_com_bbn_tc_schema_avro_cdm18_uuid, netflowobject_ipprotocol, netflowobject_uuid, fileobject_filedescriptor, unnamedpipeobject_sinkuuid, netflowobject_baseobject, unnamedpipeobject_baseobject, netflowobject_localaddress, subject_iteration, srcsinkobject_baseobject, unnamedpipeobject_baseobject_epoch, host_interfaces_name, subject_importedlibraries, netflowobject_baseobject_hostid, unnamedpipeobject_sourceuuid, principal_userid, principal_username_string, principal_properties_map, srcsinkobject_baseobject_properties_map, principal, netflowobject_localport, subject_parentsubject, srcsinkobject_filedescriptor, subject_privilegelevel, unnamedpipeobject, subject_properties, subject_cid, srcsinkobject_baseobject_epoch, host_osdetails, fileobject_baseobject_properties_map, subject_properties_map, fileobject_size, subject_properties_map_host, subject_cmdline, netflowobject_baseobject_permission, principal_uuid, srcsinkobject, fileobject, subject_parentsubject_com_bbn_tc_schema_avro_cdm18_uuid, subject_count, host, netflowobject_baseobject_epoch, netflowobject_remoteport, subject_uuid, netflowobject, fileobject_baseobject_hostid, principal_properties, host_uuid, srcsinkobject_baseobject_properties, unnamedpipeobject_uuid, netflowobject_baseobject_properties, unnamedpipeobject_baseobject_hostid, fileobject_localprincipal, host_interfaces_macaddress, fileobject_baseobject, fileobject_peinfo, netflowobject_baseobject_properties_map, cdmversion, unnamedpipeobject_sinkuuid_com_bbn_tc_schema_avro_cdm18_uuid, srcsinkobject_uuid, fileobject_hashes, netflowobject_remoteaddress, subject, subject_hostid, node_type, collected_uuid, uuid_numeration, end_column
2023-07-05 13:11:19,394 - INFO - columns_with_type created
2023-07-05 13:11:19,394 - INFO - Established connection
2023-07-05 13:11:19,767 - INFO - droped table if exists: cadets_nodes_01_record
2023-07-05 13:11:19,775 - INFO - created table: cadets_nodes_01_record
2023-07-05 13:11:19,783 - INFO - load_data_infile:
2023-07-05 13:11:29,976 - INFO - Committing and closing connection
2023-07-05 13:20:08,239 - INFO - Establishing connection
2023-07-05 13:20:08,250 - INFO - Connection established
2023-07-05 13:20:08,250 - INFO - Established connection
2023-07-05 13:20:08,250 - INFO - edge_file: /Users/robinbuchta/Documents/DARPA/cadets/01_record/output/updated_edges.csv
2023-07-05 13:20:08,250 - INFO - prepare_columns: /Users/robinbuchta/Documents/DARPA/cadets/01_record/output/updated_edges.csv
2023-07-05 13:20:08,250 - INFO - find_sql_table_type: /Users/robinbuchta/Documents/DARPA/cadets/01_record/output/updated_edges.csv
2023-07-05 13:20:09,820 - INFO - len of columns_with_datatype: 70
2023-07-05 13:20:09,821 - INFO - columns_with_type: event_parameters_array_size text, event_properties_map_arg_uid INT NULL, event_location text, event_properties_map_arg_egid varchar(255), event_parameters_array_tag text, event_properties_map_exec varchar(255), event_parameters_array_type text, event_properties_map_cmdline TEXT, event text, event_properties_map_login varchar(255), event_parameters_array_name_string text, event_hostid varchar(255), event_predicateobject2path text, event_predicateobjectpath_string varchar(255), event_size_long INT NULL, event_name text, event_parameters_array_runtimedatatype text, event_properties_map_ret_fd2 INT NULL, event_predicateobject text, event_properties_map_arg_pid INT NULL, event_properties_map_ppid INT NULL, event_uuid varchar(255), event_properties_map_fd varchar(255), event_predicateobject_com_bbn_tc_schema_avro_cdm18_uuid varchar(255), event_timestampnanos BIGINT NULL, event_type varchar(255), event_parameters_array_valuedatatype text, event_parameters_array_valuebytes text, event_properties_map_arg_gid INT NULL, event_predicateobject2 text, event_properties_map_ret_miouuid text, event_properties_map_address varchar(255), event_properties_map_arg_sgid varchar(255), event_properties_map_arg_rgid varchar(255), event_predicateobject2_com_bbn_tc_schema_avro_cdm18_uuid varchar(255), event_predicateobjectpath text, event_properties_map_arg_miouuid text, event_properties_map_arg_mem_flags varchar(255), event_properties_map_ret_fd1 INT NULL, event_parameters_array text, event_properties_map text, event_sequence text, event_subject text, event_parameters text, event_properties_map_return_value varchar(255), event_properties_map_arg_euid varchar(255), event_parameters_array_name text, event_programpoint text, event_parameters_array_provenance text, event_properties_map_arg_suid varchar(255), event_threadid text, event_parameters_array_valuebytes_bytes text, event_predicateobject2path_string varchar(255), event_parameters_array_isnull text, event_properties_map_port INT NULL, event_subject_com_bbn_tc_schema_avro_cdm18_uuid varchar(255), event_name_string varchar(255), event_sequence_long INT NULL, event_properties_map_partial_path varchar(255), event_properties_map_ret_msgid BIGINT NULL, event_properties_map_host varchar(255), event_properties text, event_properties_map_arg_ruid varchar(255), event_parameters_array_components text, event_size text, event_threadid_int INT NULL, source_numeration INT NULL, destination_numeration INT NULL, destination2_numeration INT NULL, end_column INT NULL
2023-07-05 13:20:09,821 - INFO - columns: event_parameters_array_size, event_properties_map_arg_uid, event_location, event_properties_map_arg_egid, event_parameters_array_tag, event_properties_map_exec, event_parameters_array_type, event_properties_map_cmdline, event, event_properties_map_login, event_parameters_array_name_string, event_hostid, event_predicateobject2path, event_predicateobjectpath_string, event_size_long, event_name, event_parameters_array_runtimedatatype, event_properties_map_ret_fd2, event_predicateobject, event_properties_map_arg_pid, event_properties_map_ppid, event_uuid, event_properties_map_fd, event_predicateobject_com_bbn_tc_schema_avro_cdm18_uuid, event_timestampnanos, event_type, event_parameters_array_valuedatatype, event_parameters_array_valuebytes, event_properties_map_arg_gid, event_predicateobject2, event_properties_map_ret_miouuid, event_properties_map_address, event_properties_map_arg_sgid, event_properties_map_arg_rgid, event_predicateobject2_com_bbn_tc_schema_avro_cdm18_uuid, event_predicateobjectpath, event_properties_map_arg_miouuid, event_properties_map_arg_mem_flags, event_properties_map_ret_fd1, event_parameters_array, event_properties_map, event_sequence, event_subject, event_parameters, event_properties_map_return_value, event_properties_map_arg_euid, event_parameters_array_name, event_programpoint, event_parameters_array_provenance, event_properties_map_arg_suid, event_threadid, event_parameters_array_valuebytes_bytes, event_predicateobject2path_string, event_parameters_array_isnull, event_properties_map_port, event_subject_com_bbn_tc_schema_avro_cdm18_uuid, event_name_string, event_sequence_long, event_properties_map_partial_path, event_properties_map_ret_msgid, event_properties_map_host, event_properties, event_properties_map_arg_ruid, event_parameters_array_components, event_size, event_threadid_int, source_numeration, destination_numeration, destination2_numeration, end_column
2023-07-05 13:20:09,824 - INFO - table_name_nodes: cadets_nodes_01_record
2023-07-05 13:20:09,824 - INFO - table_name_edges: cadets_edges_01_record
2023-07-05 13:20:09,856 - INFO - droped table if exists: cadets_edges_01_record
2023-07-05 13:20:09,867 - INFO - created table: cadets_edges_01_record
2023-07-05 13:20:09,893 - INFO - Index created successfully.
2023-07-05 13:20:09,893 - INFO - Created table
2023-07-05 13:20:09,893 - INFO - load_data_infile:
2023-07-05 13:24:56,058 - INFO - Loaded data
2023-07-05 13:24:56,060 - INFO - Committing and closing connection
2023-07-05 13:24:56,064 - INFO - Committed and closed connection
2023-07-05 14:23:24,222 - INFO - Getting atk nodes from config: <configparser.ConfigParser object at 0x177537a50>
2023-07-05 14:23:24,223 - INFO - read_gt_yaml:
2023-07-05 14:23:24,225 - INFO - yaml_data: {'date': '20180406', 'start_time': '11:21', 'end_time': '12:08', 'search_terms': ['elevate', 'drakon', 'nrinfo', 'nrtcp', '154.145.113.18', '61.167.39.128', './deploy/archive/libdrakon.freebsd.x64.so_152.111.159.139', '/var/log/devc', 'foo', '/var/log/devc', 'xxx', '81.49.200.166', '78.205.235.65', '200.36.109.21', '139.123.0.113', '152.111.159.139', '200.36.109.214', 'shellcode_server', 'loaderDrakon.freebsd.x64', 'drakon.freebsd.x64', 'netrecon', '(nrtcp fail)', '(nrtcp success)', '/tmp/vUgefal', '/var/log/devc', '/dev/gtx_dsa_675', '91.49.200.18', 'nginx', '/etc/passwd', '/etc/group', 'stage 1', 'oc2', '200.16.109.214', 'cmd_exec', 'vUgefal', '139.123.0.133', 'sshd']}
2023-07-05 14:23:24,225 - INFO - get_atk_nodes_from_yaml:
2023-07-05 14:23:24,225 - INFO - Scan edges
2023-07-05 14:23:24,225 - INFO - Parsing DARPA GT to UNIX NS
2023-07-05 14:23:24,225 - INFO - Parsing DARPA Hour Min Timestamp String
2023-07-05 14:23:24,225 - INFO - Parsing Timestamp String
2023-07-05 14:23:24,226 - INFO - Parsing EST
2023-07-05 14:23:24,226 - INFO - Converting datetime to DARPA UNIX
2023-07-05 14:23:24,226 - INFO - Timestamp: 2018-04-06 17:19:00
2023-07-05 14:23:24,226 - INFO - Parsed DARPA GT date: 20180406 and time: 11:21 to UNIX NS: 1.52302794e+18
2023-07-05 14:23:24,226 - INFO - Parsing DARPA GT to UNIX NS
2023-07-05 14:23:24,226 - INFO - Parsing DARPA Hour Min Timestamp String
2023-07-05 14:23:24,226 - INFO - Parsing Timestamp String
2023-07-05 14:23:24,226 - INFO - Parsing EST
2023-07-05 14:23:24,226 - INFO - Converting datetime to DARPA UNIX
2023-07-05 14:23:24,226 - INFO - Timestamp: 2018-04-06 18:10:00
2023-07-05 14:23:24,226 - INFO - Parsed DARPA GT date: 20180406 and time: 12:08 to UNIX NS: 1.523031e+18
2023-07-05 14:23:24,226 - INFO - Establishing connection
2023-07-05 14:23:24,254 - INFO - Connection established
2023-07-05 14:23:37,006 - INFO - 8866
2023-07-05 14:23:37,007 - INFO - Length of node_set: 682
2023-07-05 14:23:37,008 - INFO - Scan nodes
2023-07-05 14:23:37,008 - INFO - scan_nodes:
2023-07-05 14:23:37,008 - INFO - Establishing connection
2023-07-05 14:23:37,014 - INFO - Connection established
2023-07-05 14:23:37,015 - INFO - search_terms: ['elevate', 'drakon', 'nrinfo', 'nrtcp', '154.145.113.18', '61.167.39.128', './deploy/archive/libdrakon.freebsd.x64.so_152.111.159.139', '/var/log/devc', 'foo', '/var/log/devc', 'xxx', '81.49.200.166', '78.205.235.65', '200.36.109.21', '139.123.0.113', '152.111.159.139', '200.36.109.214', 'shellcode_server', 'loaderDrakon.freebsd.x64', 'drakon.freebsd.x64', 'netrecon', '(nrtcp fail)', '(nrtcp success)', '/tmp/vUgefal', '/var/log/devc', '/dev/gtx_dsa_675', '91.49.200.18', 'nginx', '/etc/passwd', '/etc/group', 'stage 1', 'oc2', '200.16.109.214', 'cmd_exec', 'vUgefal', '139.123.0.133', 'sshd']
2023-07-05 14:23:37,017 - INFO - columns: ['id', 'subject_localprincipal', 'principal_username', 'fileobject_baseobject_permission', 'principal_hostid', 'srcsinkobject_type', 'unnamedpipeobject_sinkfiledescriptor', 'subject_type', 'netflowobject_filedescriptor', 'host_interfaces', 'host_hostidentifiers', 'unnamedpipeobject_baseobject_properties', 'fileobject_uuid', 'host_hosttype', 'fileobject_baseobject_properties', 'principal_groupids', 'subject_starttimestampnanos', 'srcsinkobject_baseobject_hostid', 'principal_type', 'unnamedpipeobject_baseobject_permission', 'source', 'fileobject_type', 'unnamedpipeobject_baseobject_properties_map', 'datum', 'subject_exportedlibraries', 'host_interfaces_ipaddresses', 'host_hostname', 'subject_unitid', 'srcsinkobject_baseobject_permission', 'fileobject_baseobject_epoch', 'unnamedpipeobject_sourcefiledescriptor', 'unnamedpipeobject_sourceuuid_com_bbn_tc_schema_avro_cdm18_uuid', 'netflowobject_ipprotocol', 'netflowobject_uuid', 'fileobject_filedescriptor', 'unnamedpipeobject_sinkuuid', 'netflowobject_baseobject', 'unnamedpipeobject_baseobject', 'netflowobject_localaddress', 'subject_iteration', 'srcsinkobject_baseobject', 'unnamedpipeobject_baseobject_epoch', 'host_interfaces_name', 'subject_importedlibraries', 'netflowobject_baseobject_hostid', 'unnamedpipeobject_sourceuuid', 'principal_userid', 'principal_username_string', 'principal_properties_map', 'srcsinkobject_baseobject_properties_map', 'principal', 'netflowobject_localport', 'subject_parentsubject', 'srcsinkobject_filedescriptor', 'subject_privilegelevel', 'unnamedpipeobject', 'subject_properties', 'subject_cid', 'srcsinkobject_baseobject_epoch', 'host_osdetails', 'fileobject_baseobject_properties_map', 'subject_properties_map', 'fileobject_size', 'subject_properties_map_host', 'subject_cmdline', 'netflowobject_baseobject_permission', 'principal_uuid', 'srcsinkobject', 'fileobject', 'subject_parentsubject_com_bbn_tc_schema_avro_cdm18_uuid', 'subject_count', 'host', 'netflowobject_baseobject_epoch', 'netflowobject_remoteport', 'subject_uuid', 'netflowobject', 'fileobject_baseobject_hostid', 'principal_properties', 'host_uuid', 'srcsinkobject_baseobject_properties', 'unnamedpipeobject_uuid', 'netflowobject_baseobject_properties', 'unnamedpipeobject_baseobject_hostid', 'fileobject_localprincipal', 'host_interfaces_macaddress', 'fileobject_baseobject', 'fileobject_peinfo', 'netflowobject_baseobject_properties_map', 'cdmversion', 'unnamedpipeobject_sinkuuid_com_bbn_tc_schema_avro_cdm18_uuid', 'srcsinkobject_uuid', 'fileobject_hashes', 'netflowobject_remoteaddress', 'subject', 'subject_hostid', 'node_type', 'collected_uuid', 'uuid_numeration', 'end_column']
2023-07-05 14:25:46,012 - INFO - results length: 8
2023-07-05 14:25:46,014 - INFO - Length of node_set: 683
